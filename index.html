<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Singular & Plural Nouns Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.2em;
        }

        .menu-screen, .level-screen, .assessment-screen {
            display: none;
        }

        .menu-screen.active, .level-screen.active, .assessment-screen.active {
            display: block;
        }

        .level-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 30px;
        }

        .level-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px 30px;
            font-size: 1.5em;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-family: 'Comic Sans MS', cursive, sans-serif;
        }

        .level-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .level-btn.easy {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
        }

        .level-btn.medium {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .level-btn.hard {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .level-btn.assessment {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            font-size: 1.8em;
            margin-top: 20px;
        }

        .question-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            border: 3px solid #667eea;
        }

        .question-text {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 25px;
            text-align: center;
            font-weight: bold;
        }

        .options {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .option-btn {
            background: white;
            border: 3px solid #667eea;
            padding: 20px 40px;
            font-size: 1.5em;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            min-width: 150px;
        }

        .option-btn:hover {
            background: #e6e9ff;
            transform: scale(1.05);
        }

        .option-btn.correct {
            background: #56ab2f;
            color: white;
            border-color: #56ab2f;
        }

        .option-btn.incorrect {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
        }

        .feedback {
            text-align: center;
            font-size: 1.8em;
            margin: 20px 0;
            font-weight: bold;
            min-height: 40px;
        }

        .feedback.correct {
            color: #56ab2f;
        }

        .feedback.incorrect {
            color: #ff6b6b;
        }

        .progress {
            text-align: center;
            font-size: 1.3em;
            color: #667eea;
            margin: 20px 0;
            font-weight: bold;
        }

        .score {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.5em;
            margin: 20px 0;
        }

        .next-btn, .back-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.3em;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            transition: all 0.3s;
        }

        .next-btn:hover, .back-btn:hover {
            background: #764ba2;
            transform: scale(1.05);
        }

        .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .celebration {
            font-size: 3em;
            text-align: center;
            margin: 20px 0;
        }

        .image-container {
            text-align: center;
            margin: 20px 0;
        }

        .noun-image {
            font-size: 5em;
            margin: 10px 0;
        }

        .assessment-question {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin: 15px 0;
            border: 3px solid #667eea;
        }

        .assessment-sentence {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 15px;
            line-height: 1.8;
        }

        .assessment-options {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .assessment-option {
            background: white;
            border: 3px solid #667eea;
            padding: 15px 30px;
            font-size: 1.3em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Comic Sans MS', cursive, sans-serif;
        }

        .assessment-option:hover {
            background: #e6e9ff;
        }

        .assessment-option.selected {
            background: #667eea;
            color: white;
        }

        .submit-btn {
            background: #56ab2f;
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.5em;
            border-radius: 10px;
            cursor: pointer;
            margin: 30px auto;
            display: block;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            transition: all 0.3s;
        }

        .submit-btn:hover {
            background: #a8e063;
            transform: scale(1.05);
        }

        .results-screen {
            display: none;
            text-align: center;
        }

        .results-screen.active {
            display: block;
        }

        .result-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 5px solid #667eea;
            text-align: left;
        }

        .result-item.correct-answer {
            border-left-color: #56ab2f;
        }

        .result-item.wrong-answer {
            border-left-color: #ff6b6b;
        }

        .instruction {
            background: #fff9e6;
            border: 2px dashed #ffa500;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-size: 1.2em;
            color: #333;
        }

        .is-are-hint {
            background: #e6f3ff;
            border: 3px solid #4facfe;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            font-size: 1.3em;
            color: #333;
            text-align: center;
            font-weight: bold;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(500px) rotate(720deg); opacity: 0; }
        }

        .bounce {
            animation: bounce 0.5s ease;
        }

        .shake {
            animation: shake 0.5s ease;
        }

        .pulse {
            animation: pulse 0.6s ease;
        }

        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            animation: confetti 3s linear;
        }

        .try-again {
            background: #ffa500;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
            margin: 15px auto;
            display: block;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            transition: all 0.3s;
        }

        .try-again:hover {
            background: #ff8c00;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="confetti-container" id="confettiContainer"></div>
    <div class="container">
        <div class="menu-screen active">
            <h1>üåü Singular & Plural Nouns üåü</h1>
            <p class="subtitle">Choose a level to practice!</p>
            
            <div class="instruction">
                <strong>Remember:</strong> A singular noun is ONE thing. A plural noun is MORE THAN ONE thing. We usually add "s" or "es" to make words plural!<br><br>
                <strong>IS and ARE:</strong> Use "IS" with ONE thing (singular). Use "ARE" with MORE THAN ONE thing (plural).
            </div>

            <div class="level-buttons">
                <button class="level-btn easy" onclick="startLevel(1)">
                    üü¢ Level 1: Easy<br>
                    <small style="font-size: 0.7em;">Match pictures with words</small>
                </button>
                <button class="level-btn medium" onclick="startLevel(2)">
                    üü° Level 2: Medium<br>
                    <small style="font-size: 0.7em;">Choose the correct form</small>
                </button>
                <button class="level-btn hard" onclick="startLevel(3)">
                    üî¥ Level 3: Challenge<br>
                    <small style="font-size: 0.7em;">Complete sentences</small>
                </button>
                <button class="level-btn" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);" onclick="startLevel(4)">
                    üîµ Level 4: IS or ARE<br>
                    <small style="font-size: 0.7em;">Choose the correct verb</small>
                </button>
                <button class="level-btn assessment" onclick="startAssessment()">
                    ‚≠ê ASSESSMENT ‚≠ê<br>
                    <small style="font-size: 0.7em;">Circle the correct noun!</small>
                </button>
            </div>
        </div>

        <div class="level-screen" id="levelScreen">
            <div class="progress" id="progress"></div>
            <div class="score" id="score">Score: 0/0</div>
            
            <div class="question-card">
                <div class="image-container" id="imageContainer"></div>
                <div class="question-text" id="question"></div>
                <div class="options" id="options"></div>
            </div>
            
            <div class="feedback" id="feedback"></div>
            
            <div class="button-container">
                <button class="back-btn" onclick="backToMenu()">‚Üê Back to Menu</button>
                <button class="next-btn" id="nextBtn" onclick="nextQuestion()" style="display: none;">Next Question ‚Üí</button>
            </div>
        </div>

        <div class="assessment-screen" id="assessmentScreen">
            <h1>‚≠ê Assessment Time! ‚≠ê</h1>
            <div class="instruction">
                <strong>Instructions:</strong> Read each sentence carefully. Click on the correct answer: the correct form of the noun (singular or plural) OR the correct verb ("is" or "are").
            </div>
            
            <div class="progress" id="assessProgress"></div>
            
            <div id="assessmentQuestions"></div>
            
            <button class="submit-btn" onclick="submitAssessment()">Submit Assessment</button>
            
            <div class="button-container">
                <button class="back-btn" onclick="backToMenu()">‚Üê Back to Menu</button>
            </div>
        </div>

        <div class="results-screen" id="resultsScreen">
            <h1>üìä Assessment Results üìä</h1>
            <div class="celebration" id="celebration"></div>
            <div class="score" id="finalScore"></div>
            <div id="resultsList"></div>
            <div class="button-container">
                <button class="next-btn" onclick="backToMenu()">Back to Menu</button>
                <button class="next-btn" onclick="retryAssessment()">Try Again</button>
            </div>
        </div>
    </div>

    <script>
        const level1Questions = [
            {
                image: "üê±",
                question: "How many do you see?",
                answer: "One cat",
                options: ["One cat", "Two cats"]
            },
            {
                image: "üê∂üê∂",
                question: "How many do you see?",
                answer: "Two dogs",
                options: ["One dog", "Two dogs"]
            },
            {
                image: "üå∏",
                question: "How many do you see?",
                answer: "One flower",
                options: ["One flower", "Three flowers"]
            },
            {
                image: "üçéüçéüçé",
                question: "How many do you see?",
                answer: "Three apples",
                options: ["One apple", "Three apples"]
            },
            {
                image: "ü¶ã",
                question: "How many do you see?",
                answer: "One butterfly",
                options: ["One butterfly", "Two butterflies"]
            },
            {
                image: "‚≠ê‚≠ê‚≠ê‚≠ê",
                question: "How many do you see?",
                answer: "Four stars",
                options: ["One star", "Four stars"]
            },
            {
                image: "üöó",
                question: "How many do you see?",
                answer: "One car",
                options: ["One car", "Two cars"]
            },
            {
                image: "üìöüìö",
                question: "How many do you see?",
                answer: "Two books",
                options: ["One book", "Two books"]
            }
        ];

        const level2Questions = [
            {
                question: "I have one _____.",
                image: "üéà",
                answer: "balloon",
                options: ["balloon", "balloons"]
            },
            {
                question: "She has three _____.",
                image: "üç™üç™üç™",
                answer: "cookies",
                options: ["cookie", "cookies"]
            },
            {
                question: "The _____ is jumping.",
                image: "üê∏",
                answer: "frog",
                options: ["frog", "frogs"]
            },
            {
                question: "Two _____ are flying.",
                image: "ü¶Öü¶Ö",
                answer: "birds",
                options: ["bird", "birds"]
            },
            {
                question: "He sees one _____.",
                image: "ü¶í",
                answer: "giraffe",
                options: ["giraffe", "giraffes"]
            },
            {
                question: "Four _____ are in the box.",
                image: "üì¶",
                answer: "toys",
                options: ["toy", "toys"]
            },
            {
                question: "The _____ is red.",
                image: "üöó",
                answer: "car",
                options: ["car", "cars"]
            },
            {
                question: "Many _____ are on the tree.",
                image: "üå≥",
                answer: "leaves",
                options: ["leaf", "leaves"]
            }
        ];

        const level3Questions = [
            {
                question: "The _____ are playing in the park.",
                answer: "children",
                options: ["child", "children"]
            },
            {
                question: "My _____ is on the table.",
                answer: "pencil",
                options: ["pencil", "pencils"]
            },
            {
                question: "The _____ run fast in the forest.",
                answer: "foxes",
                options: ["fox", "foxes"]
            },
            {
                question: "I lost one _____.",
                answer: "tooth",
                options: ["tooth", "teeth"]
            },
            {
                question: "The _____ are swimming in the pond.",
                answer: "fish",
                options: ["fish", "fishes"]
            },
            {
                question: "She has two pet _____.",
                answer: "mice",
                options: ["mouse", "mice"]
            },
            {
                question: "The _____ is barking loudly.",
                answer: "dog",
                options: ["dog", "dogs"]
            },
            {
                question: "Many _____ live in the barn.",
                answer: "sheep",
                options: ["sheep", "sheeps"]
            },
            {
                question: "One _____ flew over the house.",
                answer: "goose",
                options: ["goose", "geese"]
            },
            {
                question: "The _____ are making a nest.",
                answer: "birds",
                options: ["bird", "birds"]
            }
        ];

        const level4Questions = [
            {
                question: "The cat _____ sleeping.",
                image: "üê±",
                answer: "is",
                options: ["is", "are"],
                hint: "ONE cat"
            },
            {
                question: "The dogs _____ running.",
                image: "üê∂üê∂",
                answer: "are",
                options: ["is", "are"],
                hint: "TWO dogs"
            },
            {
                question: "The bird _____ singing.",
                image: "üê¶",
                answer: "is",
                options: ["is", "are"],
                hint: "ONE bird"
            },
            {
                question: "The flowers _____ beautiful.",
                image: "üå∏üå∏üå∏",
                answer: "are",
                options: ["is", "are"],
                hint: "MANY flowers"
            },
            {
                question: "The apple _____ red.",
                image: "üçé",
                answer: "is",
                options: ["is", "are"],
                hint: "ONE apple"
            },
            {
                question: "The children _____ playing.",
                image: "üëßüë¶",
                answer: "are",
                options: ["is", "are"],
                hint: "MORE than one"
            },
            {
                question: "The sun _____ shining.",
                image: "‚òÄÔ∏è",
                answer: "is",
                options: ["is", "are"],
                hint: "ONE sun"
            },
            {
                question: "The balloons _____ floating.",
                image: "üéàüéàüéàüéà",
                answer: "are",
                options: ["is", "are"],
                hint: "MANY balloons"
            },
            {
                question: "My friend _____ happy.",
                image: "üòä",
                answer: "is",
                options: ["is", "are"],
                hint: "ONE friend"
            },
            {
                question: "The cars _____ fast.",
                image: "üöóüöóüöó",
                answer: "are",
                options: ["is", "are"],
                hint: "THREE cars"
            },
            {
                question: "The book _____ on the table.",
                image: "üìñ",
                answer: "is",
                options: ["is", "are"],
                hint: "ONE book"
            },
            {
                question: "The stars _____ bright.",
                image: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê",
                answer: "are",
                options: ["is", "are"],
                hint: "MANY stars"
            }
        ];

        const assessmentQuestions = [
            {
                sentence: "The _____ is eating grass.",
                options: ["cow", "cows"],
                answer: "cow"
            },
            {
                sentence: "Five _____ are in the basket.",
                options: ["egg", "eggs"],
                answer: "eggs"
            },
            {
                sentence: "My _____ helped me with homework.",
                options: ["sister", "sisters"],
                answer: "sister"
            },
            {
                sentence: "The _____ are singing beautifully.",
                options: ["bird", "birds"],
                answer: "birds"
            },
            {
                sentence: "I see one _____ in the sky.",
                options: ["cloud", "clouds"],
                answer: "cloud"
            },
            {
                sentence: "Three _____ are on the plate.",
                options: ["sandwich", "sandwiches"],
                answer: "sandwiches"
            },
            {
                sentence: "The _____ is very tall.",
                options: ["tree", "trees"],
                answer: "tree"
            },
            {
                sentence: "Many _____ are in the garden.",
                options: ["flower", "flowers"],
                answer: "flowers"
            },
            {
                sentence: "One _____ swam away quickly.",
                options: ["fish", "fishes"],
                answer: "fish"
            },
            {
                sentence: "The _____ are playing soccer.",
                options: ["boy", "boys"],
                answer: "boys"
            },
            {
                sentence: "The dog _____ barking loudly.",
                options: ["is", "are"],
                answer: "is"
            },
            {
                sentence: "The children _____ at the park.",
                options: ["is", "are"],
                answer: "are"
            },
            {
                sentence: "My pencil _____ on the desk.",
                options: ["is", "are"],
                answer: "is"
            },
            {
                sentence: "The cookies _____ delicious.",
                options: ["is", "are"],
                answer: "are"
            },
            {
                sentence: "The teacher _____ reading a story.",
                options: ["is", "are"],
                answer: "is"
            }
        ];

        let currentLevel = 0;
        let currentQuestionIndex = 0;
        let currentQuestions = [];
        let score = 0;
        let answeredQuestions = 0;
        let assessmentAnswers = {};
        let currentAttempt = 0; // Track attempts per question
        let hasSecondChance = true; // Track if second chance is available

        // Sound generation functions
        function playCorrectSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            // Play a happy ascending tone
            const frequencies = [523.25, 659.25, 783.99]; // C, E, G notes
            frequencies.forEach((freq, index) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = freq;
                oscillator.type = 'sine';
                
                const startTime = audioContext.currentTime + (index * 0.1);
                gainNode.gain.setValueAtTime(0.3, startTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + 0.3);
                
                oscillator.start(startTime);
                oscillator.stop(startTime + 0.3);
            });
        }

        function playIncorrectSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            // Play a gentle "try again" sound
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 200; // Low tone
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        function playEncouragementSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            // Play encouraging two-note sound
            const frequencies = [440, 554.37]; // A, C#
            frequencies.forEach((freq, index) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = freq;
                oscillator.type = 'triangle';
                
                const startTime = audioContext.currentTime + (index * 0.15);
                gainNode.gain.setValueAtTime(0.2, startTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + 0.3);
                
                oscillator.start(startTime);
                oscillator.stop(startTime + 0.3);
            });
        }

        function createConfetti() {
            const container = document.getElementById('confettiContainer');
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#6c5ce7', '#a29bfe', '#fd79a8', '#fdcb6e'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = (Math.random() * 0.5) + 's';
                    container.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        function startLevel(level) {
            currentLevel = level;
            currentQuestionIndex = 0;
            score = 0;
            answeredQuestions = 0;
            
            if (level === 1) {
                currentQuestions = [...level1Questions].sort(() => Math.random() - 0.5);
            } else if (level === 2) {
                currentQuestions = [...level2Questions].sort(() => Math.random() - 0.5);
            } else if (level === 3) {
                currentQuestions = [...level3Questions].sort(() => Math.random() - 0.5);
            } else if (level === 4) {
                currentQuestions = [...level4Questions].sort(() => Math.random() - 0.5);
            }
            
            document.querySelector('.menu-screen').classList.remove('active');
            document.getElementById('levelScreen').classList.add('active');
            
            showQuestion();
        }

        function showQuestion() {
            const question = currentQuestions[currentQuestionIndex];
            
            document.getElementById('progress').textContent = 
                `Question ${currentQuestionIndex + 1} of ${currentQuestions.length}`;
            document.getElementById('score').textContent = 
                `Score: ${score}/${answeredQuestions}`;
            
            if (question.image) {
                let imageHTML = `<div class="noun-image">${question.image}</div>`;
                if (question.hint && currentLevel === 4) {
                    imageHTML += `<div style="color: #667eea; font-size: 1.2em; margin-top: 10px; font-weight: bold;">üí° Hint: ${question.hint}</div>`;
                }
                document.getElementById('imageContainer').innerHTML = imageHTML;
            } else {
                document.getElementById('imageContainer').innerHTML = '';
            }
            
            document.getElementById('question').textContent = question.question;
            
            // Reset attempts for new question
            currentAttempt = 0;
            hasSecondChance = true;
            
            // Add special instruction for Level 4
            if (currentLevel === 4 && currentQuestionIndex === 0) {
                const instructionDiv = document.createElement('div');
                instructionDiv.className = 'is-are-hint';
                instructionDiv.innerHTML = 'üìö Remember: Use "IS" for ONE thing (singular) and "ARE" for MORE THAN ONE thing (plural)!';
                document.querySelector('.question-card').insertBefore(instructionDiv, document.getElementById('imageContainer'));
            } else if (currentLevel === 4) {
                const existingHint = document.querySelector('.is-are-hint');
                if (!existingHint) {
                    const instructionDiv = document.createElement('div');
                    instructionDiv.className = 'is-are-hint';
                    instructionDiv.innerHTML = 'üìö Remember: Use "IS" for ONE thing (singular) and "ARE" for MORE THAN ONE thing (plural)!';
                    document.querySelector('.question-card').insertBefore(instructionDiv, document.getElementById('imageContainer'));
                }
            }
            
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
            document.getElementById('nextBtn').style.display = 'none';
            
            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = option;
                btn.onclick = () => checkAnswer(option, btn);
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selected, btn) {
            const question = currentQuestions[currentQuestionIndex];
            const allButtons = document.querySelectorAll('.option-btn');
            const feedbackDiv = document.getElementById('feedback');
            
            currentAttempt++;
            
            if (selected === question.answer) {
                // CORRECT ANSWER!
                allButtons.forEach(b => b.style.pointerEvents = 'none');
                btn.classList.add('correct');
                btn.classList.add('bounce');
                
                // Play success sound
                playCorrectSound();
                
                // Create confetti
                createConfetti();
                
                // Show encouraging feedback based on attempt
                if (currentAttempt === 1) {
                    feedbackDiv.textContent = 'üéâ Excellent! Perfect on the first try!';
                    answeredQuestions++;
                    score++;
                } else {
                    feedbackDiv.textContent = '‚≠ê Great job! You got it!';
                    answeredQuestions++;
                    score++;
                }
                
                feedbackDiv.className = 'feedback correct pulse';
                document.getElementById('score').textContent = `Score: ${score}/${answeredQuestions}`;
                
                // Show next button or complete level
                if (currentQuestionIndex < currentQuestions.length - 1) {
                    setTimeout(() => {
                        document.getElementById('nextBtn').style.display = 'inline-block';
                        document.getElementById('nextBtn').classList.add('pulse');
                    }, 1000);
                } else {
                    setTimeout(() => {
                        showLevelComplete();
                    }, 2000);
                }
                
            } else {
                // INCORRECT ANSWER
                btn.classList.add('incorrect');
                btn.classList.add('shake');
                
                if (currentAttempt === 1 && hasSecondChance) {
                    // FIRST ATTEMPT - Give second chance
                    playIncorrectSound();
                    
                    feedbackDiv.textContent = 'ü§î Not quite! Try again - you can do it!';
                    feedbackDiv.className = 'feedback incorrect';
                    
                    // Disable the wrong button but keep others active
                    btn.style.pointerEvents = 'none';
                    btn.style.opacity = '0.5';
                    
                    // Keep other buttons clickable
                    allButtons.forEach(b => {
                        if (b !== btn) {
                            b.style.pointerEvents = 'auto';
                        }
                    });
                    
                    // Create a "Try Again!" button
                    const tryAgainBtn = document.createElement('button');
                    tryAgainBtn.className = 'try-again pulse';
                    tryAgainBtn.textContent = 'üîÑ Try Again!';
                    tryAgainBtn.onclick = () => {
                        playEncouragementSound();
                        feedbackDiv.textContent = 'üí™ You\'ve got this! Choose again!';
                        tryAgainBtn.remove();
                    };
                    
                    setTimeout(() => {
                        document.querySelector('.question-card').appendChild(tryAgainBtn);
                    }, 500);
                    
                } else {
                    // SECOND ATTEMPT or no second chance - Show correct answer
                    playIncorrectSound();
                    allButtons.forEach(b => b.style.pointerEvents = 'none');
                    
                    if (currentAttempt === 1) {
                        answeredQuestions++;
                    }
                    
                    feedbackDiv.textContent = `üí° The correct answer is "${question.answer}". Let's keep learning!`;
                    feedbackDiv.className = 'feedback incorrect';
                    
                    // Highlight the correct answer
                    allButtons.forEach(b => {
                        if (b.textContent === question.answer) {
                            b.classList.add('correct');
                            b.classList.add('pulse');
                        }
                    });
                    
                    document.getElementById('score').textContent = `Score: ${score}/${answeredQuestions}`;
                    
                    // Show next button or complete level
                    if (currentQuestionIndex < currentQuestions.length - 1) {
                        setTimeout(() => {
                            document.getElementById('nextBtn').style.display = 'inline-block';
                        }, 2000);
                    } else {
                        setTimeout(() => {
                            showLevelComplete();
                        }, 2500);
                    }
                }
            }
        }

        function nextQuestion() {
            // Remove any "Try Again" buttons
            const tryAgainBtn = document.querySelector('.try-again');
            if (tryAgainBtn) {
                tryAgainBtn.remove();
            }
            
            // Clean up animation classes
            document.getElementById('nextBtn').classList.remove('pulse');
            
            currentQuestionIndex++;
            if (currentQuestionIndex < currentQuestions.length) {
                showQuestion();
            }
        }

        function showLevelComplete() {
            const percentage = Math.round((score / answeredQuestions) * 100);
            let message = '';
            let emoji = '';
            
            if (percentage >= 80) {
                message = 'Amazing work! You\'re a superstar! üåü';
                emoji = 'üéäüéâüèÜ';
            } else if (percentage >= 60) {
                message = 'Great job! Keep practicing! üëç';
                emoji = 'üòäüëè';
            } else {
                message = 'Good try! Practice makes perfect! üí™';
                emoji = 'üåà‚ú®';
            }
            
            document.getElementById('question').textContent = `Level ${currentLevel} Complete!`;
            document.getElementById('imageContainer').innerHTML = `<div class="celebration">${emoji}</div>`;
            document.getElementById('options').innerHTML = '';
            document.getElementById('feedback').textContent = message;
            document.getElementById('feedback').className = 'feedback correct pulse';
            document.getElementById('nextBtn').style.display = 'none';
            
            // Play celebration sound and create confetti
            playCorrectSound();
            setTimeout(() => createConfetti(), 300);
        }

        function startAssessment() {
            assessmentAnswers = {};
            
            document.querySelector('.menu-screen').classList.remove('active');
            document.getElementById('assessmentScreen').classList.add('active');
            
            const container = document.getElementById('assessmentQuestions');
            container.innerHTML = '';
            
            assessmentQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'assessment-question';
                questionDiv.innerHTML = `
                    <div class="assessment-sentence">
                        ${index + 1}. ${q.sentence}
                    </div>
                    <div class="assessment-options">
                        ${q.options.map(opt => 
                            `<button class="assessment-option" onclick="selectAnswer(${index}, '${opt}', this)">
                                ${opt}
                            </button>`
                        ).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
            
            updateAssessProgress();
        }

        function selectAnswer(questionIndex, answer, btn) {
            const questionDiv = btn.closest('.assessment-question');
            const allOptions = questionDiv.querySelectorAll('.assessment-option');
            
            allOptions.forEach(opt => opt.classList.remove('selected'));
            btn.classList.add('selected');
            btn.classList.add('pulse');
            
            // Play a soft click sound
            playEncouragementSound();
            
            assessmentAnswers[questionIndex] = answer;
            updateAssessProgress();
        }

        function updateAssessProgress() {
            const answered = Object.keys(assessmentAnswers).length;
            document.getElementById('assessProgress').textContent = 
                `Answered: ${answered}/${assessmentQuestions.length}`;
        }

        function submitAssessment() {
            if (Object.keys(assessmentAnswers).length < assessmentQuestions.length) {
                alert('Please answer all questions before submitting!');
                return;
            }
            
            let correct = 0;
            const results = [];
            
            assessmentQuestions.forEach((q, index) => {
                const userAnswer = assessmentAnswers[index];
                const isCorrect = userAnswer === q.answer;
                
                if (isCorrect) correct++;
                
                results.push({
                    question: q.sentence,
                    userAnswer: userAnswer,
                    correctAnswer: q.answer,
                    isCorrect: isCorrect
                });
            });
            
            showResults(correct, results);
        }

        function showResults(correct, results) {
            document.getElementById('assessmentScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.add('active');
            
            const percentage = Math.round((correct / assessmentQuestions.length) * 100);
            
            let emoji = '';
            if (percentage >= 90) {
                emoji = 'üåüüéâüèÜ';
            } else if (percentage >= 80) {
                emoji = 'üéäüëèüòä';
            } else if (percentage >= 70) {
                emoji = 'üëçüí™';
            } else {
                emoji = 'üåà‚ú®';
            }
            
            document.getElementById('celebration').textContent = emoji;
            document.getElementById('celebration').className = 'celebration pulse';
            document.getElementById('finalScore').textContent = 
                `You got ${correct} out of ${assessmentQuestions.length} correct! (${percentage}%)`;
            
            // Play celebration sound and confetti for good scores
            if (percentage >= 70) {
                playCorrectSound();
                createConfetti();
            } else {
                playEncouragementSound();
            }
            
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '<h3 style="margin: 20px 0;">Your Answers:</h3>';
            
            results.forEach((r, index) => {
                const resultDiv = document.createElement('div');
                resultDiv.className = `result-item ${r.isCorrect ? 'correct-answer' : 'wrong-answer'}`;
                resultDiv.innerHTML = `
                    <strong>${index + 1}. ${r.question}</strong><br>
                    Your answer: <strong>${r.userAnswer}</strong> ${r.isCorrect ? '‚úì' : '‚úó'}<br>
                    ${!r.isCorrect ? `Correct answer: <strong>${r.correctAnswer}</strong>` : ''}
                `;
                resultsList.appendChild(resultDiv);
            });
        }

        function retryAssessment() {
            document.getElementById('resultsScreen').classList.remove('active');
            startAssessment();
        }

        function backToMenu() {
            document.getElementById('levelScreen').classList.remove('active');
            document.getElementById('assessmentScreen').classList.remove('active');
            document.getElementById('resultsScreen').classList.remove('active');
            document.querySelector('.menu-screen').classList.add('active');
        }
    </script>
</body>
</html>
